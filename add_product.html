<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel = "stylesheet" href = "./css/login.css">
    <link rel = "stylesheet" href = "./css/tablecss.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <title> Sign up </title>
</head>
<body>
    <form method="POST" name="myform" class="boxcon" action="javascript:void(0);" onsubmit="validateForm()">
        <p>
            <label>token
                <input type="text" name="token" required>
            </label>
        </p>
        <p>
            <label>product name
                <input type="text" name="product_name" required>
            </label>
        </p>

        <p>
            <label>product description
                <input type="text" name="text_descr" required>
            </label>
        </p>

        <p>
            <label>freezer id
                <input type="number" name="freezer_id" required>
            </label>
        </p>

        <p>
            <label>type id
                <input type="number" name="type_id" required>
            </label>
        </p>

        <p>
            <label>date in
                <input type="datetime-local" pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}" name="date_in"required>
            </label>
        </p>

        <p>
            <label>period
                <input type="number" name="period"required>
            </label>
        </p>

        <p>
            <label>box num
                <input type="number" name="box_num" required>
            </label>
        </p>

        <p>
            <label>produ num
                <input type="number" name="prod_num" required>
            </label>
        </p>

        <p>
            <label>quantity
                <input type="number" name="quantity" required>
            </label>
        </p>
        <input type="submit" name ="submit">

    </form>
</body>

<!-- <h1 onclick="return validateForm()">Click on this text!</h1> -->

<script>
function validateForm() {
    var token = document.forms["myform"]["token"].value;
    console.log(token);
    console.log(document.getElementsByTagName('input'));
    console.log(document.forms["myform"].length);
    var length = document.forms["myform"].length;
    var data = document.forms["myform"].elements;
    var my_test = {};
    for (i =0; i < length; i++) {
        console.log("data" + data[i].name);
        console.log(data[i].name != 'token');
        if (data[i].name != 'token' && data[i].name != 'submit'){
            my_test[data[i].name] = data[i].value;
        }
    }
    console.log(my_test);
    var http = new XMLHttpRequest();
    var url = "http://localhost:5000/add_product/"+ token;
    http.open("POST", url, true);

    //Send the proper header information along with the request
    http.setRequestHeader("Content-type", "application/json");

    http.onreadystatechange = function() {//Call a function when the state changes.
        if(http.readyState == 4 && http.status == 200) {
            alert(http.responseText);
        } else {
            alert(http.responseText);
        }
    }
    http.send(JSON.stringify(my_test));
}
</script>

</html>
